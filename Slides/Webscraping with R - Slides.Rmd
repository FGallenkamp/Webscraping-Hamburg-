---
title: "Web Scraping mit R"
author: "Fabian Gülzau (HU Berlin)"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  slidy_presentation: default
subtitle: Workshop an der Universität Hamburg
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
if(!require("pacman")) install.packages("pacman")
p_load(tidyverse, knitr, httr)
```

## Inhalt

 > "If programming is magic, then web scraping is wizardry" (Mitchell 2015: vii)

1. Einleitung
2. Struktur des WWW
3. Kurzanleitung & Toolbox
4. Rechtliche Aspekte
5. Literatur(hinweise)
6. "hands-on"-Übungen

## Einleitung

> "...something big is going on" (Salganik 2018: 2)

- Übergang vom analogen zum digitalen Zeitalter
    - Kommende Krise der empirischen Soziologie (Savage & Burrows 2007)
    - Neue Möglichkeiten und/oder Gefahren
    
 > "'computational social science' (CSS) is occurring. The question is whether
 > it happens with or without social scientists" (Heiberger & Riebling 2016: 1)
    
## Neue Möglichkeiten: Beispiele

Exemplarische Studien:

- King et al. (2013) ["How Censorship in China Allows Government Criticism but 
Silences Collective Expression"](http://bit.ly/2E1Yjhc)
- Budak & Watts (2015) ["Dissecting the Spirit of Gezi: Influence vs. Selection
in the Occupy Gezi Movement"](https://www.sociologicalscience.com/articles-v2-18-370/)
- Törnberg & Törnberg (2016) ["Combining CDA and topic modeling: Analyzing
discursive connections between Islamophobia and anti-feminism on an online forum"](https://journals.sagepub.com/doi/abs/10.1177/0957926516634546#articleShareContainer)

## Censorship in China

<div style="float: left; width: 50%;">
King et al. (2013):

- **Frage**: Was wird zensiert?
- **Vorgehen**: Online-Beiträge erheben und prüfen, welche zensiert werden
- **Daten**: 11 Millionen Beiträge auf 1,382 Webseiten 
- **Ergebnisse**: Kritische Beiträge sind erlaubt; soziale Mobilisierung nicht
</div>

<div style="float: right; width: 50%;">
![<font size="3">Chacha: Chinese Internet Police</font>](Figures/Chacha - Internet Police.png)
</div>

## Digitale Daten

- positiv: big, always-on, nonreactive
- negativ: incomplete, inaccessible, nonrepresentative, drifting, algorithmically 
confounded, sensitive

(Salganik 2018: 17-41)

## Struktur des WWW

<div style="float: left; width: 70%;">
Infrastruktur des Internets meist irrelevant.

Unser Browser übernimmt:

- Serveranfragen (Request/Response: HTTP)
- Darstellung von HTML, CSS und JavaScript

Um Informationen gezielt abzufragen, benötigen wir allerdings basale Kenntnisse 
der zugrundeliegenden Technologien.
</div>

<div style="float: right; width: 30%;">
![<font size="3">[Transatlantisches Seekabel](https://davegreer.cc/INTERNET)</font>](Figures/Hibernia Atlantic transoceanic cable landing.jpg)
</div>

## HTTP 

**H**yper**t**ext **T**ransfer **P**rotocol 

```{r}
# Source: https://code.tutsplus.com/tutorials/http-the-protocol-every-web-developer-must-know-part-1--net-31177
include_graphics("Figures/http-request-response.png")
```

- Übertragungsprotokoll, welches aus zwei Teilen besteht:

    - Request (Client)
    - Response (Server)

## HTTP

- Requests erfolgen über **U**niform **R**esource **L**ocators [(URL)](https://en.wikipedia.org/wiki/URL)
    - Teile der URL können genutzt werden, um Informationen zu extrahieren
    
```{r}
# Source: https://code.tutsplus.com/tutorials/http-the-protocol-every-web-developer-must-know-part-1--net-31177
include_graphics("Figures/http-url-structure.png")
```

## Beispiel: HTTP

- `GET` request mit `httr::GET` und response des Servers

```{r, echo = TRUE, eval = TRUE}
#install.packages("httr")
library(httr)
response <- GET("https://www.wiso.uni-hamburg.de/fachbereich-sozoek/professuren/lohmann/team/hertel-florian.html") %>%
  print()
```

## HTML

**H**yper**t**ext **M**arkup **L**anguage [(HTML)](https://www.w3schools.com/html/default.asp)

- Einfacher Text mit weiteren Anweisungen (Tags, Attributes...)
    - Wird vom Browser interpretiert und dargestellt
    
- HTML-Code ist über die Webentwicklungstools des Browsers verfügbar
    - Rechtsklick -> Element untersuchen (Firefox)

## Beispiel: HTML I

Einfache Seiten über Editor/Notepad++ erstellbar:

```{html, eval = FALSE, echo = TRUE}
<!DOCTYPE html>
<html>

<head>
<title>Workshop Web Scraping</title>
</head>

<body>
<h1> Web Scraping mit R, Universit&auml;t Hamburg</h1>
<p>Dieser Kurs f&uuml;hrt in das "Web Scraping" mit R ein. Er wird durch <a href="https://fguelzau.rbind.io/">Fabian G&uuml;lzau</a> geleitet.</p>

</body>
</html>
```

Der Browser interpretiert den Code und zeigt eine [Internetseite](http://htmlpreview.github.io/?https://github.com/FabianFox/Webscraping-Hamburg-/blob/master/Code/HTML-Example.html) an.

## Beispiel: HTML II

HTML:

- hat eine Baumstruktur
- Markup-Elemente helfen uns Informationen zu lokalisieren (Relationalität)
    - **D**ocument **O**bject **M**odel [(DOM)](https://en.wikipedia.org/wiki/Document_Object_Model)
    - Darstellung von HTML in R (parsing)
    
```{r}
# Source: https://www.wiso.uni-hamburg.de/fachbereich-sozoek/professuren/lohmann/team/hertel-florian.html
include_graphics("Figures/TreeStructure.png")
```

## CSS

**C**ascading **S**tyle **S**heet [(CSS)](https://www.w3schools.com/css/default.asp)

- beinhaltet Informationen über den Stil der HTML-Seite
- kann genutzt werden, um Informationen zu lokalisieren (CSS-Selektoren)

```{r}
# Source: https://en.wikipedia.org/wiki/Cascading_Style_Sheets
include_graphics("Figures/CSS-Example.png")
```

## JavaScript

[JavaScript](https://www.w3schools.com/js/default.asp): Programmiersprache des Internets

- macht Internetseiten dynamisch

```{r}
# Source: https://pudding.cool/2018/12/3d-cities-story/
include_graphics("Figures/JavaScript-Example.png")
```
Source: [The Pudding (2018)](https://pudding.cool/2018/12/3d-cities-story/)